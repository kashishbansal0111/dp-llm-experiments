Run Type,LLM Used,Target Epsilon,Final Epsilon,Target Delta,Max Grad Norm,Accuracy,F1 (Stroke),Precision (Stroke),Recall (Stroke),LLM Epsilon Suggestion,LLM Reasoning,dataset
Kaggle Stroke Prediction Non-DP SGD,N/A,N/A,N/A,N/A,N/A,0.7201565557729941,0.2185792349726776,0.12658227848101267,0.8,N/A,N/A,cleaned_healthcare_stroke
Kaggle Stroke Prediction Fixed DP SGD,N/A (Fixed Defaults),1.0,0.9919730191286247,0.0002446183953033268,1.0,0.9510763209393346,0.0,0.0,0.0,1.0,Using fixed defaults for Kaggle Stroke Prediction.,cleaned_healthcare_stroke
Kaggle Stroke Prediction Gemini DP SGD,gemini-2.5-pro-exp-03-25,3.0,2.997967014695898,0.000245,10.0,0.9393346379647749,0.27906976744186046,0.3333333333333333,0.24,3.0,"The recommended DP settings aim to balance privacy requirements in a 'Healthcare' domain with the need for model utility, especially given the imbalanced 'stroke' target variable.

1.  **`target_epsilon` (3.0)**: Healthcare data is sensitive, warranting strong privacy protection (lower epsilon). However, predicting a rare event like 'stroke' (highly imbalanced target) requires sufficient learning signal. An epsilon of 3.0 is a moderate value, offering a reasonable privacy guarantee while aiming to preserve enough data utility for the model to learn meaningful patterns, especially for the minority class. Extremely low epsilon values would likely render the model ineffective for this task due to excessive noise.

2.  **`target_delta` (0.000245)**: This value is derived from the common heuristic `1/N`, where N is the training set size (approx. 4088). So, delta ≈ 1/4088 ≈ 0.0002446. A small delta ensures that the probability of an arbitrary privacy violation is very low, aligning with standard DP practices. This value is preferable to a generic small constant as it's tied to the dataset size.

3.  **`max_grad_norm` (10.0)**: This parameter is critical for DP-SGD. For Logistic Regression, especially with normalized/scaled features, gradients are generally well-behaved. However, the dataset exhibits significant class imbalance for the 'stroke' target (249 positive vs 4861 negative in the training set). Gradients from the minority class (positive 'stroke' samples) are infrequent but crucial for learning. A very low `max_grad_norm` (e.g., 1.0) might aggressively clip these important gradients, disproportionately hindering the model's ability to learn to identify the 'stroke' class. A higher value like 10.0 (compared to a generic default) is chosen to allow more signal from these rare instances to pass through, potentially improving recall and F1-score for the minority class. This assumes features are properly scaled beforehand, which helps stabilize overall gradient magnitudes. This value is a starting point and may require empirical tuning.

4.  **Preprocessing**: Strict adherence to preprocessing steps like scaling is vital before applying DP-SGD, as gradient clipping sensitivity (`max_grad_norm`) is directly affected by feature magnitudes. Given the imbalance, evaluation metrics focused on the minority class are paramount.

5.  **`column_sensitivity_epsilon`**: These are conceptual relative sensitivity scores for the input features. Columns directly related to health conditions (`hypertension`, `heart_disease`, `avg_glucose_level`) or strong quasi-identifiers (`age`) are marked with higher sensitivity. These scores reflect the inherent privacy risk of the information contained within each column before any transformation or DP mechanism is applied.",cleaned_healthcare_stroke
Kaggle Stroke Prediction Groq (llama-3.3-70b-versatile) DP SGD,llama-3.3-70b-versatile,2.5,2.498573232322061,1e-05,10.0,0.9432485322896281,0.21621621621621623,0.3333333333333333,0.16,2.5,"The target epsilon of 2.5 balances the need for model utility in the healthcare domain with the sensitivity of patient data. A target delta of 1e-5 is chosen to provide a high level of privacy protection. The max grad norm of 10.0 is selected to preserve minority class signals in the imbalanced dataset, while preventing single points from dominating the gradient. Normalization and encoding of features are suggested to improve model performance. Column sensitivity epsilons are assigned based on the relative sensitivity of each feature, with higher values indicating greater sensitivity.",cleaned_healthcare_stroke
Kaggle Stroke Prediction Groq (qwen-qwq-32b) DP SGD,qwen-qwq-32b,3.0,2.9901946997241087,1e-05,10.0,0.9403131115459883,0.18666666666666668,0.28,0.14,3.0,"1. **target_epsilon=3.0**: Balances healthcare data sensitivity (requires stronger privacy than epsilon=1) while maintaining utility for a critical medical task. 2. **target_delta=1e-5**: Prioritizes privacy by using a fixed small delta (lower than 1/N=2.45e-4) to minimize tail risk. 3. **max_grad_norm=10.0**: Mitigates gradient clipping's impact on the minority class (stroke positives are 6% of training data). A higher clip norm (vs default 1.0) preserves rare-class signal gradients, preventing underfitting. 4. **Column Sensitivity**: Medical features (e.g., hypertension, avg_glucose_level) receive highest sensitivity (0.9) due to privacy risks, while demographic features (e.g., work_type) have lower scores. Grouped features (age_group) inherit sensitivity from their raw counterparts. 5. **Normalization/Scaling**: Mandatory for DP-SGD stability and to ensure gradient clipping operates on comparable scales across features. Imbalanced classes require careful gradient handling to avoid minority class gradients being drowned out by majority-class noise.",cleaned_healthcare_stroke
Kaggle Stroke Prediction Groq (gemma2-9b-it) DP SGD,gemma2-9b-it,3.0,2.9901946997241087,1e-05,10.0,0.9217221135029354,0.25925925925925924,0.2413793103448276,0.28,3.0,"The chosen DP settings are based on a balance between privacy and utility.  A `target_epsilon` of 3.0 provides a reasonable level of privacy protection while still allowing for effective model training. The `target_delta` of 1e-5 ensures a very low probability of privacy breaches.  The `max_grad_norm` of 10.0 is set higher than typical defaults to mitigate the impact of gradient clipping on the minority class (stroke) in the imbalanced dataset. This helps preserve the signal from rare positive samples.  The `column_sensitivity_epsilon` values are conceptual estimates based on the potential sensitivity of each feature to privacy.  For example, age and avg_glucose_level are likely to have a higher sensitivity than categorical features like gender or smoking_status.  These values can be further refined based on empirical analysis and experimentation.",cleaned_healthcare_stroke
Kaggle Stroke Prediction Groq (deepseek-r1-distill-llama-70b) DP SGD,deepseek-r1-distill-llama-70b,3.0,2.9984645104692276,0.0002446183953033268,10.0,0.9354207436399217,0.21428571428571427,0.2647058823529412,0.18,3.0,"The target epsilon of 3.0 balances privacy and utility needs for healthcare data, providing sufficient privacy while maintaining model accuracy. The target delta is set to 1/4088, which is appropriate given the dataset size, ensuring a strong privacy guarantee. The max_grad_norm of 10.0 is chosen to accommodate the class imbalance, preserving gradients from the minority class. Column sensitivity values are assigned based on feature types, with higher sensitivity for numerical features like age, avg_glucose_level, and bmi, and lower for categorical features. Preprocessing steps ensure data is properly prepared for training.",cleaned_healthcare_stroke
